{% extends "app/layouts/base.j2" %}
{% block main_content %}
<div class="bsk-panel bsk-panel-default">
  <header class="bsk-panel-heading">
    <dl class="bsk-dl-lg bsk-dl-striped bsk-dl-horizontal bsk-dl-horizontal-lg">
      <dt>Forecast history:</dt>
        <dd>{{ icenet_metadata['history'] }}</dd>
      <dt>Forecast period:</dt>
      {% if "date_range" in icenet_metadata %}
        <dd>{{ icenet_metadata['start_date'] }} - {{ icenet_metadata['end_date'] }}</dd>
      {% else %}
        <dd>Data incomplete...</dd>
      {% endif %}
      <dt>Pipeline metadata:</dt>
        <dd>{{ icenet_metadata['source']|trim }}</dd>
      <dt>Data metadata:</dt>
        <dd>{{ icenet_metadata['spatial_resolution'] }} in {{ icenet_metadata['geospatial_bounds_crs'] }}</dd>
    </dl>
  </header>
  <main class="bsk-panel-body">

    {% if False %}

    <div class="bsk-row">
      <div class="bsk-col-12-md-6 bsk-docs-content-block" style="text-align:center;">
      {% if "date_range" in icenet_metadata %}
        {% for picture_date in icenet_metadata["date_range"] %}
        <img src="{{ url_for("/api.icenet_app_icenet_get_image",
                             forecast_date=icenet_metadata["init_date"],
                             image="sic_mean.{}.png".format(picture_date.strftime("%Y%m%d"))) }}"
             class="fc_image fc_image_sic"
             id="fc_image_sic_{{ picture_date.strftime("%Y%m%d") }}"
             alt="Image of forecast on {{ picture_date.strftime("%Y%m%d") }}" />
        {% endfor %}
      {% else %}
        <p>Data incomplete...</p>
      {% endif %}
      </div>
      <div class="bsk-col-12-md-6 bsk-docs-content-block">
      {% if "date_range" in icenet_metadata %}
        {% for picture_date in icenet_metadata["date_range"] %}
        <img src="{{ url_for("/api.icenet_app_icenet_get_image",
                             forecast_date=icenet_metadata["init_date"],
                             image="sic_stddev.{}.png".format(picture_date.strftime("%Y%m%d"))) }}"
             class="fc_image fc_image_stddev"
             id="fc_image_stddev_{{ picture_date.strftime("%Y%m%d") }}"
             alt="Standard deviation of ensemble of forecast on {{ picture_date.strftime("%Y%m%d") }}" />
        {% endfor %}
      {% else %}
        <p>Data incomplete...</p>
      {% endif %}
      </div>
    </div>

    {% else %}

    <div class="bsk-row">
      <div class="bsk-col-12-md-6 bsk-docs-content-block">...</div>
      <div class="bsk-col-12-md-6 bsk-docs-content-block">...</div>
    </div>

    {% endif %}

    <div class="bsk-row">
      <div class="bsk-col-12-md-12 bsk-docs-content-block" style="text-align:center;">
        {{ date_picker(icenet_metadata["date_range"]) }}
      </div>
    </div>
    <div class="bsk-row">
      <div class="bsk-col-12-md-6 bsk-docs-content-block">
        {{ icenet_trend_mean }}
      </div>
      <div class="bsk-col-12-md-6 bsk-docs-content-block">
        {{ icenet_trend_stddev }}
      </div>
    </div>
    <div class="bsk-row">
      <div class="bsk-col-12-md-6 bsk-docs-content-block">
        {{ icenet_sie_change }}
      </div>
      <div class="bsk-col-12-md-6 bsk-docs-content-block">&nbsp;</div>
    </div>
    <div class="bsk-row">
      <div class="bsk-col-12-md-12 bsk-docs-content-block bsk-text-muted">
        <br /><br />
        <p>All data is &copy; British Antarctic Survey and The Alan Turing Institute 2023 and made
        available via the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/">Open Government License</a>
        which is compatible with the <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a>.</p>
        <br />
        <p>The data, imagery and graphs contained on this page are development forecast materials produced
        by the IceNet pipeline for demonstration and research purposes only.</p>
      </div>
    </div>
  </main>
</div>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script type="text/javascript" language="javascript">
        var fc_image_cur_id = $("img.fc_image_sic").first().attr('id').slice(-8);
        console.log("First image shown is " + fc_image_cur_id);
        $("img.fc_image_sic").hide();
        $("img.fc_image_stddev").hide();
        $("img#fc_image_sic_" + fc_image_cur_id).show();
        $("img#fc_image_stddev_" + fc_image_cur_id).show();
    </script>
{% endblock %}